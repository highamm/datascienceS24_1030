---
title: "Section 11: Merging and Joining"
author: "Matt Higham"
format: 
  html:
    embed-resources: true
---

## Class Exercises

Class Exercise 0.

a. 5 rows

b. 6 rows

c. 8 rows

d. 3 rows

e. 3 rows

f. 2 rows

Class Exercise 1. With bind_cols(), you have to be sure that the two data frames (1) have the same number of rows and (2) the order of the two dtaa frames is exactly the same.

Class Exercise 2.

```{r}
library(here)
slumajors_df <- read_csv(here("data/SLU_Majors_17_21.csv"))
collegemajors_df <- read_csv(here("data/college-majors.csv"))
head(slumajors_df)
#> # A tibble: 6 × 3
#>   Major                        nfemales nmales
#>   <chr>                           <dbl>  <dbl>
#> 1 Anthropology                       35     13
#> 2 Art & Art History                  62     11
#> 3 Biochemistry                       15      6
#> 4 Biology                           152     58
#> 5 Business in the Liberal Arts      192    301
#> 6 Chemistry                          28     20
head(collegemajors_df)
#> # A tibble: 6 × 12
#>   Major         Total   Men Women Major_category Employed Full_time Part_time
#>   <chr>         <dbl> <dbl> <dbl> <chr>             <dbl>     <dbl>     <dbl>
#> 1 PETROLEUM EN…  2339  2057   282 Engineering        1976      1849       270
#> 2 MINING AND M…   756   679    77 Engineering         640       556       170
#> 3 METALLURGICA…   856   725   131 Engineering         648       558       133
#> 4 NAVAL ARCHIT…  1258  1123   135 Engineering         758      1069       150
#> 5 CHEMICAL ENG… 32260 21239 11021 Engineering       25694     23170      5180
#> 6 NUCLEAR ENGI…  2573  2200   373 Engineering        1857      2038       264
#> # ℹ 4 more variables: Unemployed <dbl>, Median <dbl>, P25th <dbl>,
#> #   P75th <dbl>

left_join(slumajors_df, collegemajors_df, join_by(Major == Major))
## this doesn't work because the keys need to match __exactly__
## can do a "fuzzy join" if the keys are close but not exact
```

Class Exercise 3.

```{r}
library(tidyverse)
mortality_df <- read_csv(here("data/gun_violence_us.csv"))

dc_df <- tibble(state = "DC", mortality_rate = 16.7,
                ownership_rate = 0.087, region = "NE")
all_df <- bind_rows(mortality_df, dc_df)
```

Class Exercise 4.

```{r}
df1 <- as_tibble(state.x77)
df2 <- as_tibble(state.abb)
states_df <- bind_cols(df1, df2)
## must assume that the data frames follow the same
## order.
```

Class Exercise 5.

```{r}
states_df |> relocate(value)
all_df
left_join(all_df, states_df, join_by(state == value))
full_join(all_df, states_df, join_by(state == value))
```

Class Exercises 6 - 8

Class Exercise 6.

```{r}
inner_join(all_df, states_df, join_by(state == value))
left_join(states_df, all_df, join_by(value == state))
```

Class Exercise 7.

```{r}
states_df
ne_df <- all_df |> filter(region == "NE")
semi_join(states_df, ne_df, join_by(value == state))
```

Class Exercise 8.

```{r}
notne_df <- all_df |> filter(region != "NE")
anti_join(states_df, notne_df, join_by(value == state))
```

## Your Turns

Your Turn 1.

a. true (see venn diagrams)

b. true (see venn diagrams)

c. false: left join leaves in the rows that don't have a match while semi_join() filters out any row in the first data set that does not have a match.

Your Turn 2.

a. 6 rows.

b. 8 rows

c. 10 rows

d. 4 rows

e. 4 rows

f. 2 rows

Your Turn 3. Skip

Your Turn 4.

a. 300 rows (there are no duplicates in info_df)

b. 5 rows (5 rows have a matching key in courses_df)

c. 285 rows (300 minus the 5 * 3 that are in the second data set).

d. 5 * 3 = 15 rows (all other professors get dropped).

e. 310 rows = 15 rows (inner_join) + 285 (dropped from the first in the inner_join) + 10 (dropped from the second in the inner_join).





